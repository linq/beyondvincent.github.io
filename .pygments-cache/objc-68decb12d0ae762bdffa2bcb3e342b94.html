<div class="highlight"><pre><span class="k">@interface</span> <span class="nc">Encoder</span> <span class="p">()</span>
<span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span> <span class="n">copy</span><span class="p">)</span> <span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="n">completionHandler</span><span class="p">)();</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">Encoder</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">encodeWithCompletionHandler:</span><span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="p">)())</span><span class="nv">handler</span>
<span class="p">{</span>
    <span class="n">self</span><span class="p">.</span><span class="n">completionHandler</span> <span class="o">=</span> <span class="n">handler</span><span class="p">;</span>
    <span class="c1">// do the asynchronous processing...</span>
<span class="p">}</span>

<span class="c1">// This one will be called once the job is done</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">finishedEncoding</span>
<span class="p">{</span>
    <span class="n">self</span><span class="p">.</span><span class="n">completionHandler</span><span class="p">();</span>
    <span class="n">self</span><span class="p">.</span><span class="n">completionHandler</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span> <span class="c1">// &lt;- Don&#39;t forget this!</span>
<span class="p">}</span>

<span class="k">@end</span>
</pre></div>