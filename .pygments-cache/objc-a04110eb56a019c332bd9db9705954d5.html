<div class="highlight"><pre><span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">movehandle:</span><span class="p">(</span><span class="n">CGPoint</span><span class="p">)</span><span class="nv">lastPoint</span><span class="p">{</span>
<span class="err">     </span>
<span class="err">    </span><span class="c1">//Get the center</span>
<span class="err">    </span><span class="n">CGPoint</span> <span class="n">centerPoint</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
<span class="err">                                                                            </span><span class="n">self</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="err">     </span>
<span class="err">    </span><span class="c1">//Calculate the direction from the center point to an arbitrary position.</span>
<span class="err">    </span><span class="kt">float</span> <span class="n">currentAngle</span> <span class="o">=</span> <span class="n">AngleFromNorth</span><span class="p">(</span><span class="n">centerPoint</span><span class="p">,</span> 
<span class="err">                                                                                </span><span class="n">lastPoint</span><span class="p">,</span> 
<span class="err">                                                                                </span><span class="n">NO</span><span class="p">);</span>
<span class="err">    </span><span class="kt">int</span> <span class="n">angleInt</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">currentAngle</span><span class="p">);</span>
<span class="err">     </span>
<span class="err">    </span><span class="c1">//Store the new angle</span>
<span class="err">    </span><span class="n">self</span><span class="p">.</span><span class="n">angle</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">-</span> <span class="n">angleInt</span><span class="p">;</span>
<span class="err"> </span>
<span class="err">    </span><span class="c1">//Update the textfield </span>
<span class="err">    </span><span class="n">_textField</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span><span class="err"> </span> <span class="p">[</span><span class="n">NSString</span> <span class="nl">stringWithFormat:</span><span class="s">@&quot;%d&quot;</span><span class="p">,</span> 
<span class="err">                                                                                                    </span><span class="n">self</span><span class="p">.</span><span class="n">angle</span><span class="p">];</span>
<span class="err">     </span>
<span class="err">    </span><span class="c1">//Redraw</span>
<span class="err">    </span><span class="p">[</span><span class="n">self</span> <span class="n">setNeedsDisplay</span><span class="p">];</span>
<span class="p">}</span> 
</pre></div>